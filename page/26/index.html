<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
	<title>Rebooting Reiot</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="Social Game Developer wandering strange dungeon...">
	<meta name="author" content="Ray Yun">

    <!-- Le styles -->
	
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
      }
    </style>
    <link href="/assets/css/bootstrap-responsive.min.css" rel="stylesheet">
	

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/assets/ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="/assets/ico/apple-touch-icon-57-precomposed.png">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/">Rebooting Reiot</a>
          <div class="nav-collapse">
            <ul class="nav">
              <li class="active"><a href="/">Home</a></li>
              <li><a href="/archives/">Archives</a></li>
              <li><a href="/category/">Categories</a></li>
              <li><a href="/tag/">Tags</a></li>
			  
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

	
<div class="container">

	<div class="row">
		<div class="span9">
			
				<article>
	<div class="page-header">
		<h1><a href="/2006/10/20/조금은-오래된-재미있는-it-개발자들의-토론/">조금은 오래된, 재미있는 IT 개발자들의 토론</a> <small>2006-10-20</small></h1>
	</div>
	<div><p><a href="http://www.javaservice.net/~java/bbs/read.cgi?m=resource&amp;b=chat2&amp;c=r_p&amp;n=1097846224&amp;p=6&amp;s=t#1097846224">2004년 자바서비스넷의 어느 청년의 고민담</a>에 달린 수많은 리플들. IT 개발자라면 한번쯤 읽어봤으면 한다. 내 안에도 찌질이가 살고 있지만, 저렇게 살고 싶지는 않다. 그리고 중간에 일본사는넘이라는 분의 이야기는 꼭 읽어보기를.</p>
<p>그러고보니 내가 스물 다섯일 때는 얼른 10억 벌고 서른살에 은퇴해서 캐나다에서 송어 낚시를 하는게 꿈이었는데... 벌써 서른 둘이 되어 버렸다.</p></div>
	
</article>
			
				<article>
	<div class="page-header">
		<h1><a href="/2006/10/19/steam-war-함대전-mmofps/">Steam War : 함대전 MMOFPS</a> <small>2006-10-19</small></h1>
	</div>
	<div><p><a href="http://www.lazeska.com/" class="imagelink" title="라제스카"><img alt="라제스카" src="http://boxcatstudio.files.wordpress.com/2009/07/lz.jpg" /></a><br />
<a href="http://www.lazeska.com/">이 그림 한장 </a>덕분에 잊혀졌던 함대전 MMOFPS의 추억이 되살아났다. (역시나 수백번 글로 써봐도 그림 한장이 주는 감동은 따라갈 수 없다) 어쨌든, 한동안 비공개로 해놓고 혼자 끄적여 봤는데, 아무래도 몇 년 동안은 MMO 개발을 할 수 없을 것 같아서 이참에 공개해본다. 재미로 쓴 글이므로 현실감이 없더라도 웃으면 곤란. 핫핫.<a href="http://boxcatstudio.files.wordpress.com/2009/07/203.jpg"><br />
</a></p>
<pre><code>- 드넓은 하늘에서 수백, 수천대의 비행선, 비공정들이 펼치는 치열한 대규모 공중전. (그렇다. 레이옷은 XBOX의 크림슨 스카이에서 많은 감명을 받았다. 물론 코난이나 나우시카, 라퓨타, 붉은돼지 같은 지브리표 비공정도 무척 좋아한다. 무엇보다도 멋진 것은 은하영웅전설의 멋진 전술과 전략들을 리얼타임으로 구현해 내는 것.)
- 때는 1940년대, 증기기관이 전세계적 주동력이 되어버린 팩션(가상역사)의 세계. 신기술을 기반으로 나치 동맹군은 세계대전을 일으킨다. 플레이어는 연합군과 동맹군, 중립국연합 중의 하나의 세력을 선택해서 전쟁을 치른다.
- 다른 플레이어들 또는 AI 편대를 이끌고 나치(혹은 연합군)를 무찔러라. 수 십 대의 모선에서 출발한 수 백 대의 프로펠러기가 날아다니며, 수 백개의 미사일, 수 천발의 총알 속에서 살아남아라. 거대한 비공정을 건조하고, 수 십대의 동료 모선들과 함께 전략을 구상하고 전술을 실행하라. 히틀러, 괴벨, 롬멜, 처칠 같은 영웅 NPC가 지휘하는 초거대비공정을 수백명의 동지들과 함께 공략하라. (레이드?)
- 레벨이 올라가면 다수의 편대를 이끌거나, 보다 거대하고 화력이 강한 비행선을 조종할 수 있다. 대형 비공정은 여러 플레이어가 역할을 분담해서 움직여야 한다.
- 모든 비행기들은 증기 기관 또는 열기구를 주 동력원으로 사용하며, 이동을 위해서는 프로펠러를 사용한다. 오직 작은 미사일만이 화약추진체를 사용할 수 있다.  기본적인 무기는 느린 대포와 빠른 기관총, 그리고 아주 초기적인 유도 성능을 가진 미사일 만을 사용할 수 있다. 초기적인 레이다를 사용할 수 있다.  상대를 무찌르면 무기, 부품 등의 아이템이 떨어진다. 현상금을 받아 돈을 벌어 비행기를 업그레이드하거나 새로 산다. 부품이나 완제품을 경매장에 사고 팔 수 있다.
- 세계 지도를 띄우면 언제 어디에서 전투가 일어나는지를 확인할 수 있다. 여기에서 AI 대전 또는 플레이어 대전을 선택하고 전투에 임한다. 각 전투 지역에는 몇 명이 참가해서 몇 분동안 싸우고 있는지 확인할 수 있다. 100 명 이상이 참가할 수 있는 대규모 전투는, 일정 시간마다 리스폰된다. 세계 지도에는 초대형 모선의 위치가 그려진다. 대체로 전투는 이 주위에서 이루어진다.
- 전투 지역을 선택하면 AI가 움직이는 대형 모선에서 전투가 시작된다. (대체로 전투는 비슷한 규모로 시작된다. 만약 규모가 다르면 AI에 의해서 조정된다.) 이 대형 모선은 맵의 정반대편에서 대기하고 있으며, 방어력과 공격력이 좋아서 혼자 힘으로는 파괴하기가 어렵다. 불리할 경우 모선 안으로 대피해서 후퇴할 수 있다.
</code></pre>
<p>누가 빨리 만들어주세요. 매달 이만오천원 이하면 결제해 드립니다.</p></div>
	
</article>
			
				<article>
	<div class="page-header">
		<h1><a href="/2006/09/20/otl-tips/">OTL Tips</a> <small>2006-09-20</small></h1>
	</div>
	<div><p><strong><em>[공지사항] 이 글은 더이상 업데이트되지 않으며, 최신 버전은<a href="http://reiot.springnote.com/pages/87217"> http://reiot.springnote.com/pages/87217</a>에서 읽으실 수 있습니다. </em></strong></p>
<p><a href="http://otl.sourceforge.net/">OTL</a>은 ODBC를 잘 래핑한 오픈소스 DB 쿼리 라이브러리이다. 헤더 파일 하나만 있으면, 굳이 ODBC 래퍼 클래스를 만들지 않아도 충분히 안심하고 쓸 수 있으며, MYSQL, MSSQL, ORACLE 모두에 사용될 수 있다. 꽤 여러 곳에서 사용되고 있고, 평판도 좋다고 알려져 있어서 써봤는데, 대략 반년동안 사용해본 경험으로는, 차라리 OLE DB 를 쓰거나, ODBC 래핑 라이브러리를 어딘가에서 갖다 쓰는 게 더 개발기간을 단축시킬 수 있다고 판단된다. OTL 만의 미묘한 버그스러움이 너무 많기에... '''비추천'''이었다. 그러나 최근에 legacy code를 손보면서 raw ODBC 코드를 만지다가 결국 포기하고 다시 OTL을 도입한 적도 있어서, 뭐라고 표현하기는 난감하지만 하나 확실한 건, ODBC를 직접 만지는 것보다는 백만배 정도 나으므로, 한번 써보기를 권한다.</p>
<h3>data binding</h3>
<p>OTL type 과 ODBC type 과의 대응표를 잘못 기억했다가는 마감 시간에 낭패를 보는 경우가 있다. 특히 헷갈리는 타입들을 적어본다.<br />
<table><br />
<thead><br />
<th>ODBC</th><br />
<th>OTL</th><br />
<td>bit</td><br />
<td>int</td><br />
<td>tinyint</td><br />
<td>int</td></p>
<tr>
<td>smallint</td>
<td>short</td>
</tr>

<tr>
<td>datetime/smalldatetime</td>
<td>char[N] (only for explicit-binding select)</td>
</tr>

<p></thead></table><br />
implicit_select 에서는 datetime -&gt; string 바인딩은 지원되지 않으므로, convert() 등으로 변환해서 string 으로 받아야 한다. 그런데, explicit binding select 에서는 웬지 지원이 된다. 이유는....모른다... <img alt="(" src="http://boxcatstudio.files.wordpress.com/2009/07/icon_sad.gif" /></p>
<p>timestamp 타입을 받으려면 아무래도 otl_datetime 을 사용하는 편이 좋을 것 같다. 그리고, built-in type 으로 바인딩을 하는 것보다는, otl_value<T>를 쓰면 NULL 체크도 되니깐 추천.</p>
<h3>output parameter + implicit_select</h3>
<p>잘 되던 프로시저의 output 파라미터의 값이 이상해진다든지 꼬일 경우, 새로 추가된 로직에 select 가 들어가있는지를 확인할 것. (ODBC의 한계는 아닌 듯한데) OTL에서의 프로시저는 output 파라미터만을 가지든, implicit_select 만을 하든, 둘 중 하나만 해야 한다. 아래와 같이 둘 다 할 경우 바보가 된다.</p>
<pre><code>
CREATE procedure test_proc
@param int output
AS
....
SELECT something FROM tbl
IF @@error &lt;&gt; 0 OR @@rowcount &lt;&gt; N
....
</code></pre>

<p>위와 같은 코드들은 assignment select 로 해결하면 된다.</p>
<h3>otl_implicit_select</h3>
<p>output parameter 가 아닌, 내부에서 select 를 하는 프로시저의 경우 이 옵션을 명시해줘야 한다. 주의할 점은, datetime 이나 smalldatetime 을 내부에서 select 하고, OTL 에서 스트링으로 받으면 incompatible datatype 예외가 던져진다. 이때에는 varchar(N)으로 cast/convert 하는 것을 권장한다.</p>
<h3>SET NOCOUNT ON/OFF</h3>
<p>OTL/ODBC 의 가장 극악한 버그(?) 중의 하나이다.</p>
<p>OTL 은 @@rowcount 와 다른 output parameter 또는 select 결과를 구분할 수 없다고 한다. 그래서, SET NOCOUNT 를 설정해야만 프로시저에서 값을 제대로 읽어올 수 있다. (이 문제 때문에 얼마나 많은 시간을 날려버렸던가!! 만약 OTL 에서 프로시저를 제대로 실행할 수 없다면 90% 는 이 문제라고 보면 된다.)</p>
<p>주의할 점은, 프로시저 내부에서 다른 프로시저를 호출할 때 하위 프로시저에서 SET NOCOUNT OFF 를 해 버리면 그 뒤의 결과값 역시 꼬여버리게 된다는 점이다. 따라서, '''OTL 에서 직접 호출하는 프로시저의 시작과 끝에만 SET NOCOUNT 를 설정하고, 다른 프로시저에서는 절대 사용하지 말 것을 권장한다.'''</p>
<h3>Multiple ResultSet</h3>
<p>OTL/ODBC 에서는 공식 지원하지 않는다. 실제로 해보면 첫번째 result set 은 잘 받지만 두번째 이후부터는 eof() 가 되어 버린다. 결국, 해킹을 하거나 포기하는 수 밖에 없는데... 그래도 강제 실행을 시도해보겠다면 대략 다음과 같이 해 보기를... (내부 구조가 복잡해서 결국 포기했지만...)</p>
<p>otl_stream stmt(1,<br />
"{CALL get_multi_resultset(:p<int,in>)}",<br />
conn,<br />
otl_implicit_select);<br />
stmt &lt;&lt;(int)1;<br />
otl_cur &amp; s = (**stmt.ss).cursor_struct;<br />
SQLRETURN result = SQLMoreResults( s.cda );</p>
<h3>Binding varchar</h3>
<p>문자열 바인딩시 NULL 을 위한 공간을 2바이트씩 예비해두어야 한다. 예를 들면, otl_statement 로 바인딩시 VARCHAR(10) 컬럼의 값을 읽거나 쓰려면 :XXX<char[12]> 를 사용해야 한다는 뜻이다.</p>
<h3>Constant SQL Statements</h3>
<p>dynamic binding 이 필요없을 경우 otl_cursor::direct_exec() 를 사용해야 한다. '''반대로 말하면 otl_stream 에 static sql 을 사용하지 말라!''' rpc 를 알고 싶다면 otl_cursor::direct_exec() 의 리턴값을 사용하면 된다.</p>
<h3>otl_connect::auto_commit_on()</h3>
<p>otl_cursor::direct_exec() 를 이용해서 insert/delete 를 호출할 경우, 암시적인 트랜잭션이 발생해서 관련된 테이블이나 row 에 IX 를 걸게 된다. 따라서 다른 커넥션(otl_connect)에서 관련 테이블에 쿼리를 하게 되면 블로킹되는 불상사가 발생할 수 있다. 또는 아예 처음부터 커넥션 자체에 auto_commit_on()를 설정해서, 매 쿼리 실행마다 자동적으로 commit 를 하도록 하면 좋다.</p>
<p>otl_stmt::set_commit()도 비슷한 역할을 하는 게 아닐까 추측한다.  그런데, 이 옵션을 켰을 때 동일 커넥션에 대해서 여러번 쿼리를 하는 경우 이미 사용중이라는 에러 메시지가 나온다. 도대체.... ㅠㅠ</p>
<h3>ODBC Connection Pooling 기능 추가하기</h3>
<p>OTL을 ThreadPooling 과 함께 사용하기 위해서는 Connection Pooling 이 필수적이다. (그렇지 않으면 Thread Local Storage를 사용해야 하는데, 이는 권장하지 않는다고 빌게이츠가 말했다 ㅎㅎ)</p>
<p>테스트삼아, 단순한 SELECT COUNT(*) FROM XXX를 ThreadPooling 을 이용해서 로컬랜에 설치된 MSSQL 서버에 N번 쿼리를 큐잉하고 GetTickCount()로 시간을 체크해보았다. 이때, 풀링을 사용할 경우 평균 쿼리 시간이 5ms 정도 낮게 나왔으며 최소 쿼리 시간이 0 인 횟수가 꽤 많이 나왔다. 풀링을 하지 않을 경우에는 99% 의 확률로 10ms 이상의 시간이 소모되었다.</p>
<pre><code>- 주의사항 i. shared environment 생성 전, 즉 rlogin() 전에 풀링을 설정해야 한다!! i. env 즉 프로세스당 풀링 대신 시스템 전체에서 연결을 풀링하고 싶다면 SQL_CP_ONE_PER_DRIVER(?)를 사용하면 된다.
</code></pre>
<p>inline<br />
bool SQL_OK ( SQLRETURN nResult )<br />
{<br />
return nResult == SQL_SUCCESS || nResult == SQL_SUCCESS_WITH_INFO;<br />
}</p>
<p>void EnableConnectionPooling()<br />
{<br />
// enable connection pooling per environment<br />
SQLRETURN ret = SQLSetEnvAttr(SQL_NULL_HANDLE,<br />
SQL_ATTR_CONNECTION_POOLING,<br />
(LPVOID)SQL_CP_ONE_PER_HENV,<br />
0);<br />
BOOST_REQUIRE( SQL_OK(ret) );<br />
}</p>
<p>void DisableConnectionPooling()<br />
{<br />
SQLRETURN ret = SQLSetEnvAttr(SQL_NULL_HANDLE,<br />
SQL_ATTR_CONNECTION_POOLING,<br />
(LPVOID)SQL_CP_OFF,<br />
0);<br />
BOOST_REQUIRE( SQL_OK(ret) );<br />
}</p>
<p>bool IsConnectionPooling()<br />
{<br />
DWORD value;<br />
SQLRETURN ret = SQLGetEnvAttr(SQL_NULL_HANDLE,<br />
SQL_ATTR_CONNECTION_POOLING,<br />
&amp;value,<br />
0,<br />
NULL);<br />
BOOST_REQUIRE( SQL_OK(ret) );</p>
<p>if ( value == SQL_CP_ONE_PER_HENV || value == SQL_CP_ONE_PER_DRIVER )<br />
{<br />
return true;<br />
}<br />
else if ( value == SQL_CP_OFF )<br />
{<br />
return false;<br />
}<br />
else<br />
{<br />
BOOST_ERROR( "error" );<br />
}<br />
return false;<br />
}</p>
<h3>precreated handle 사용하기</h3>
<p>Connection Pooling 을 사용할 때, otl_connect::rlogin()을 쓰게 되면 매번마다 id/passwd 를 파싱하고 environment handle 을 생성하는 등 불필요한 부하가 있다. 따라서 미리 shared environment handle 을 하나 할당하고, hdbc handle 도 만들어서 객체를 생성하면 비교적 나을 것이다.</p>
<h3>스트림 풀링</h3>
<p>스트림의 풀이 otl_connect 객체 내부에 존재하므로, 이 객체를 항상적으로 유지해야만 풀링의 효과를 볼 수 있다.</p>
<h3>테스트 결과</h3>
<p>1000개의 단순쿼리({{{SELECT COUNT(*) FROM XXX}}})를 ThreadPooling을 이용해서 처리, 그 시간을 살펴보았다. 첫번째를 제외하고는 모든 상황에서</p>
<pre><code>- NO_POOLING : 매 작업마다 재연결 시도
- POOLING : 단지 ODBC Connection Pooling 옵션만 설정하고 위와 같음
- ODBC_POOLING : 미리 env 1개를 생성하고 매 작업마다 hdbc handle 만 생성해서 쿼리하기
- OTL_POOLING : 아예 otl_connect 객체를 자체 풀링시킴
- OTL_POOLING_NO_STREAM_POOLING : 위와 같지만 ODBC 풀링과 스트림 풀링을 끈 상태
</code></pre>
<table>
<thead>
<th>Query Type</th>
<th>minTick</th>
<th>maxTick</th>
<th>avgTick</th>
<th>#threads</th>
<td>NO_POOLING</td>
<td>0</td>
<td>47</td>
<td>12</td>
<td>4</td>
<td>POOLING</td>
<td>0</td>
<td>47</td>
<td>10</td>
<td>4</td>

<tr>
<td>ODBC_POOLING</td>
<td>0</td>
<td>78</td>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>OTL_POOLING_NO_STREAM_POOLING</td>
<td>0</td>
<td>78</td>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>OTL_POOLING</td>
<td>0</td>
<td>32</td>
<td>0</td>
<td>2</td>
</tr>
</thead></table>

<p>결론적으로 otl_connect 객체를 자체적으로 풀링하는 방법이 가장 빨랐다. 그러나, 스트림 풀링을 끄면 2위인 ODBC_POOLING과 비슷한 걸로 봐서 스트림 풀링의 비용이 꽤 높다는 것을 알 수 있다. (쿼리 자체를 좀더 복잡하게 해서 테스트해야 나을 거 같다.)</p>
<p>see also:</p>
<pre><code>- http://snaiper80.cafe24.com/wiki/wiki.cgi?OTL
</code></pre></div>
	
</article>
			
				<article>
	<div class="page-header">
		<h1><a href="/2006/09/09/log4cxx/">Log4cxx</a> <small>2006-09-09</small></h1>
	</div>
	<div><p><img alt="http://logging.apache.org/images/ls-logo.jpg" src="http://logging.apache.org/images/ls-logo.jpg" /></p>
<p>서버 프로그래머라면 빠르고 간편한 로그와 트레이스에 대해서 한번쯤은 고민해봤을 것이다. 파일 로그 또는 윈도우의 이벤트 로그를 보통 쓰고 있겠지만, 생각보다 편하지 않은게 사실이다. 그런 의미에서 이번 기회에 <a href="http://logging.apache.org/log4cxx/index.html">Log4j을 C++로 포팅한 Log4cxx</a>의 특징에 대해서 알아보는 시간을 가져봤다.</p>
<p>다음 내용은 <a href="http://logging.apache.org/log4cxx/manual/Introduction.html">Log4cxx의 개요 문서</a>를 축약한 것이므로, 가능하면 본문을 읽어보기를 권장한다.</p>
<pre><code>- 이름 기반으로 계층화(hierarchical)된 로그 지원 : 종류별 로그 객체를 만들어둘 필요가 없이, 필요할 때마다 이름을 키값으로 로그 객체에 접근하면 된다. 가령 system.net 은 system.net.packet 의 상위 계층이 된다.
- 상속 지원 : 하위 계층에 속한 로그들은 상위 계층의 로그에게 종속된다. 윈도우의 이벤트 로그과 비슷하게 로그 레벨(DEBUG-INFO-WARN-ERROR-FATAL)을 지원하며, 이 역시 상속 기반으로 동작한다.
- 복수의 Appender 지원 : 하나의 로그 객체에 콘솔, 파일, 이벤트로그, 소켓 등 여러 가지 종류의 출력 스트림(Appender)을 2개 이상 붙일 수 있다. 당연히 비동기적으로 동작한다.
- XML 기반의 외부 환경 설정 파일 지원 : 각 로그 객체의 on/off 부터 레이아웃(==포맷팅)까지 모두 외부 환경 파일에서 설정 가능하다.
- 고성능 : 굳이 #ifdef … #endif 로 지우지 않고 그냥 off 만 해둬도 함수 호출 하나 + 정수 연산 정도의 부하만 준다.
</code></pre>
<p>잘 찾아보면 <a href="http://www.codeproject.com/csharp/TraceTool.asp?df=100&amp;forumid=28124&amp;exp=0&amp;select=1261034&amp;fr=26">log4j/log4net 등의 출력을 GUI로 이쁘게 보여주는 유틸리티</a>도 없지 않으므로, 굳이 까만 콘솔 화면을 뚫어지게 쳐다보기 보다는 저런 툴을 활용해보는 건 어떨까 싶다. 물론 라이브 로그도 지원해줘야 하고, 손쉬운 필터링과 검색 기능이 들어가야 하겠지만…</p>
<p>가장 좋은 건, 데몬을 띄워두면 패널에 아이콘화되어 있다가, 에러가 발생하면 깜빡거리며 툴팁이 뜨고, 이를 클릭하면 어플리케이션 이름-시간-내용 메시지를 보여주는 모니터링 어플리케이션을 만들어 두는 것이다. 마찬가지로 필터링 기능이 들어가야 하겠지만.</p></div>
	
</article>
			
				<article>
	<div class="page-header">
		<h1><a href="/2006/09/09/activex/">ActiveX</a> <small>2006-09-09</small></h1>
	</div>
	<div><p><strong><em>[공지사항] 이 페이지는 더이상 업데이트되지 않으며, 최신 버전은 <a href="http://reiot.springnote.com/pages/87215">http://reiot.springnote.com/pages/87215</a> 에서 읽으실 수 있습니다.</em></strong></p>
<p>어쩌다보니 ActiveX를 이용해서 브라우저에서 클라이언트를 실행하는 작업을 도와주게 되었다. 담당자나 나나 이 쪽으로는 거의 지식이 전무한 상태였는데, 삽질을 반복하면서 여러 가지 유용한 정보들을 알아내었다. 이미 귀국 날짜가 연기된 마당이므로 시간도 널널하고 해서 알아낸 점들을 정리해본다.</p>
<p>혹시라도 이 분야에 처음 발을 들였다면 <a href="http://www.codeproject.com/com/CompleteActiveX.asp">A Complete ActiveX Web Control Tutorial</a>를 꼭 읽어보기 바란다. 물론 <a href="http://en.wikipedia.org/wiki/ActiveX">위키피디아</a>의 설명도 괜찮다.</p>
<h2>설치 여부 알아내기</h2>
<p><a href="http://game.paran.com/">파란닷컴</a>처럼 active-x 컨트롤이 설치되지 않은 컴퓨터에 대해서 설치 안내 페이지로 redirect 시키려면, onerror 이벤트를 이용하면 된다.</p>
<p><a href="http://december.com/html/4/element/script.html">&lt;script</a> language="javascript" for="mycontrol" event="onerror"&gt;<br />
location.href = '/redirect/to/how-to-install.html';<br />
</script></p>
<p><a href="http://december.com/html/4/element/object.html">&lt;OBJECT</a> ID='mycontrol' CLASSID='....' codebase=....&gt;<br />
<a href="http://december.com/html/4/element/span.html"><SPAN></a>Active-X control not installed. go to <a href="http://december.com/html/4/element/a.html">&lt;a</a> href="/redirect/to/how-to-install.html"&gt;HOW TO INSTALL Active-X</a> page</SPAN><br />
</OBJECT></p>
<p>이때 OBJECT 태그 사이의 코드들은 해당 객체가 로드되지 않을 경우 렌더링된다는 점을 잘 활용하면 좋을 것이다.</p>
<h2>삭제하기</h2>
<p>XP 의 경우 $WINDOWS/Downloaded Program Files/ 아래에서 삭제하면 된다. Windows 2003 의 경우는 어디인지 확인할 수 없었다.</p>
<h2>컨트롤 활성화</h2>
<p>올해부터 IE에서는 <a href="http://www.microsoft.com/korea/windows/ie/ie6/activex/activate/default.mspx">컨트롤이나 애플릿들이 기본적으로 비활성화 상태로 변경되</a>었다. 이를 수정하는 방법은 자바스크립트 코드를 이용해서 OBJECT 태그를 쓰면 된다. 보다 자세한 사항은 <a href="http://support.microsoft.com/kb/914257/ko">HOWTO</a> 문서를 참고할 것.</p>
<p><a href="http://december.com/html/4/element/script.html"><script></a><br />
document.write('<a href="http://december.com/html/4/element/object.html">&lt;object</a> classid="CLSID:..." type="application/x-oleobject" codebase="..." width="320" height="240"&gt; </object>');<br />
</script></p>
<h2>ActiveX Control Pad</h2>
<p>마이크로소프트에서 제공하는 유틸리티인데 실제로 마소에서는 받아지질 않는다. 따라서 <a href="http://www.download.com/ActiveX-Control-Pad/3000-2406_4-861343.html?tag=pop">여기</a>서 받을 것.</p>
<h2>브라우저로 이벤트 전달하기</h2>
<p>만약 ActiveX 컨트롤에서 click 등의 마우스 이벤트 핸들러를 정의했다면 javascript 레벨에서 동일한 이벤트 핸들러를 정의할 수 없다. 이는 컨트롤이 이벤트를 먹어버리기 때문으로 보이는데, 이를 해결하려면 컨트롤에서 이벤트를 정의하고 브라우저로 보내준 다음 브라우저에서 핸들링을 하면 된다.</p>
<p>Public Event CloseBrowser()<br />
Public Sub OnClick()<br />
' handle click event<br />
RaiseEvent CloseBrowser() ' fire event<br />
End</p>
<p><a href="http://december.com/html/4/element/script.html">&lt;script</a> language="javascript" for="mycontrol" event="closebrowser"&gt;<br />
self.close();<br />
</script></p></div>
	
</article>
			
			<ul class="pager">
			
			  	<li class="previous">
			    	<a href="/page/27/">&larr; Older</a>
			  	</li>
		  	
		  	
				<li class="next">
					<a href="/page/27">Newer &rarr;</a>
				</li>
		  	
			</ul>
		</div>
		<div class="span3">
			<ul class="nav nav-list well">
	<li class="nav-header">
		Recent Posts
	</li>
	
	<li>
		<a href="/2006/10/20/조금은-오래된-재미있는-it-개발자들의-토론/">조금은 오래된, 재미있는 IT 개발자들의 토론</a>
	</li>
	
	<li>
		<a href="/2006/10/19/steam-war-함대전-mmofps/">Steam War : 함대전 MMOFPS</a>
	</li>
	
	<li>
		<a href="/2006/09/20/otl-tips/">OTL Tips</a>
	</li>
	
	<li>
		<a href="/2006/09/09/log4cxx/">Log4cxx</a>
	</li>
	
	<li>
		<a href="/2006/09/09/activex/">ActiveX</a>
	</li>
	
</ul>
		</div>
	</div>

</div> <!-- /container -->


    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
	
    <script src="/assets/js/jquery.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>
	

  </body>
</html>